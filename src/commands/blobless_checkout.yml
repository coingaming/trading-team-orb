description: >
  Checkout repository blobless

steps:
  - run:
      name: Checkout
      command: |
        mkdir -p /root/.ssh
        ssh-keyscan github.com >> ~/.ssh/known_hosts
        echo '-----BEGIN OPENSSH PRIVATE KEY-----' > ~/.ssh/id_rsa_1
        echo $GITHUB_DEPLOY_PRIVATE_KEY >> ~/.ssh/id_rsa_1
        echo '-----END OPENSSH PRIVATE KEY-----' >> ~/.ssh/id_rsa_1
        ssh-add -D
        chmod 600 ~/.ssh/id_rsa_1
        echo "Clonning repository coingaming/$CIRCLE_PROJECT_REPONAME.git"
        GIT_SSH_COMMAND="ssh -i ~/.ssh/id_rsa_1" git clone --filter=blob:none -b "$CIRCLE_BRANCH" "git@github.com:coingaming/$CIRCLE_PROJECT_REPONAME.git"
